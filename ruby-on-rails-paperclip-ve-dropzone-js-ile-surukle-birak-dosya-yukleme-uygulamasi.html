<!DOCTYPE html>
<html class='no-js' lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>lab2023 | Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması
</title>
<meta content='Designers and developers for hire' name='description'>
<meta content='design, ruby on rails, ios, android, sencha, istanbul, ankara, denizli' name='keywords'>
<link href="assets/stylesheets/application.css" media="screen" rel="stylesheet" type="text/css" />
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" media="screen" rel="stylesheet" type="text/css" />
<link href="assets/images/favicon.png" rel="icon" type="image/png" />
<meta content='Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması' name='description'>
<meta content='paperclip, dropzone' name='keywords'>


</head>
<body id='blog'>
<header class='header'>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1'>
<a href="/blog"><img class="logo pull-right" alt="" width="252" height="253" src="assets/images/logo.png" />
</a>
</div>
<div class='col-lg-8'>
<h1>
<a href="/blog">lab2023's blog posts</a>
<a target="_blank" href="http://lab2023.com/feed.xml"><i class='fa fa-rss'></i>
</a>
</h1>
<p>
<a href="/"><i class='fa fa-arrow-circle-left'></i>
lab2023.com
</a>
</p>
</div>
</div>
</div>
</header>

<!-- share-buttons js code -->
<div id='fb-root'>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/tr_TR/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
  (function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs'));
</script>
</div>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1 article-meta'>
<h5>July  6, 2013</h5>
<span class='tag'><a href="/tag/paperclip.html">paperclip</a></span>
<span class='tag'><a href="/tag/dropzone.html"> dropzone</a></span>
<!-- Share buttons -->
<ul class='share_button'>
<li>
<div class='fb-share-button' data-href='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' data-type='button_count'></div>
</li>
<li>
<a class='twitter-share-button' data-text='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' data-via='lab2023' href='https://twitter.com/share'></a>
</li>
<li>
<script src='//platform.linkedin.com/in.js' type='text/javascript'>
<![CDATA[
    lang: en_US
]]>
</script>
<script data-url='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' type='IN/Share'></script>
</li>
</ul>
</div>
<div class='col-lg-8'>
<article class='post'>
<h1>Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması</h1>
<p><strong>Dropzone.js</strong></p>

<p>Daha önceki projelerde jquery-fileupload-rails gemini kullanmıştım ama onlarca satır haml ve erb kodu yazmak pek içime sinmemişti bu işin daha basit bir yöntemi olmalı demiştim bu arayışıta dropzone ile karşılaştım basitliği ve eski tarayıcılara destek vermemesi beni cezbetti (like a jquery 2)</p>

<!--more-->

<p><strong>Diğerlerinden Farkı</strong></p>

<ul>
<li>  Küçük boyut</li>
<li>  Framework bağımsız</li>
<li>  Güncel Tarayıcı API&#39;leri</li>
<li>  Sade Tasarım</li>
<li>  Resimlerde Küçültülmüş önizleme</li>
</ul>

<h1 id="kurulum"><strong>Kurulum</strong></h1>

<p>Rails projemizi oluşturalım</p>

<p><code>rails new rails-paperclip-dropzone-example</code></p>

<h2 id="gemler">Gemler</h2>

<p>Rails projemize ilk olarak dropzonejs-rails ve paperclip gemlerini dahil ediyoruz.</p>

<p>gem &lsquo;dropzonejs-rails&rsquo;
    gem &lsquo;paperclip&rsquo;</p>

<h2 id="assets">Assets</h2>

<p>application.css.sass</p>

<p>@import &lsquo;dropzone/dropzone&rsquo;</p>

<p>application.js.coffee</p>

<p>#= require dropzone</p>

<h2 id="scaffold">Scaffold</h2>

<p>Gerekli model ve controllerları scaffold yardımıyla oluşturalım.</p>

<p><code>rails g scaffold product name:string</code></p>

<p><code>rails g scaffold photo photo:attachment product:references</code></p>

<p>prodcut.rb model dosyasına aşağıdaki ilişkiyi tanımlıyoruz.</p>

<p>has_many :photos</p>

<h1 id="kullanımı"><strong>Kullanımı</strong></h1>

<p>application.js.coffee</p>

<p>Dropzone.options.photoDropzone =
      paramName: <q>photo</q>
      maxFilesize: 2 #mb
      addRemoveLinks: true
      init: -&gt;
        @on &lsquo;removedfile&rsquo;, (file) -&gt;
          if file.xhr
            $.ajax
              url: <q>#{$(</q>#photo-dropzone<q>).attr</q>action<q>}/#{JSON.parse(file.xhr.response).id}</q>
              type: &lsquo;DELETE&rsquo;</p>

<p>Sürükle bırak formu için aşağıdaki kodu formun çıkmasını istediğimiz haml dosyasına yazıyoruz.</p>

<p>= form_for [@product, Photo.new], multipart: true, html: {class: :dropzone, id: &lsquo;photo-dropzone&rsquo;} do |f|
      = f.hidden_field :photo
      = f.hidden_field :product_id, value: @product.id</p>

<p>Controller içinde sadece create methodunun bulunması yeterli tabi dropzone içersinde silmek için buton çıkarabileceğiniz bir ayar mevcut bununla birlikte silme gibi işlemleri halledebileceğinizi düşünüyorum.</p>

<p>def create
      @photo = Photo.create(photo: params[:photo], product_id: params[:photo][:product_id])
      render json: @photo
    end</p>

<p>def destroy
      @photo = Photo.find(params[:id])
      @photo.destroy
      render nothing: true
    end</p>

<p>Toplamda 10 satırda projelerinize sürükle bırak dosya yükleme formu yapabilirsiniz. <img alt="dropzonejs" width="881" height="550" src="assets/images/articles/2013-07-06-dropzone.png" /></p>

<p>5 ay sonra gelen güncelleme:</p>

<p>Silme işlemi eklendi. Kodumuz silme işleminide ekleyince 10 satırı geçti kusura bakmayın artık. :D ileride demo uygulama yapabilirim validasyon mesajlarını gösteren serverda thumnail oluşunca güncellemeli falan..</p>

<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'lab2023';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>
Please enable JavaScript to view the
<a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
</noscript>
<a class='dsq-brlink' href='http://disqus.com'>
comments powered by
<span class='logo-disqus'>Disqus</span>
</a>
</article>
</div>
</div>
</div>
<footer class='footer'>
<h4>© 2014 LAB2023, CORP.</h4>
<p>The all designs, materials and contents trademarks of lab2023, corp.</p>
</footer>

</body>
<!-- Javascripts -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js" type="text/javascript"></script>
<script src="assets/javascripts/application.js" type="text/javascript"></script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12243799-3']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</html>
